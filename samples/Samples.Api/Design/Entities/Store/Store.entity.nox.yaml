#
# Store.entity.nox.yaml
#
# yaml-language-server: $schema=https://noxorg.dev/schemas/Entity.json
#

name: Store
description: Cache Store
pluralName: Stores
table: Store
schema: dbo

raiseCrudEvents: 
  create: yes
  update: yes
  delete: no

ownedRelationships:
  - name: Reservations
    entity: Reservation
    description: Pre-arranged excanged operation at the store by a specific client.
    isMany: true
    isRequired: true # to model 1-1* or 1-0* relations

  - name: CacheBalances
    entity: CurrencyCacheBalance
    description:
    isMany: true
    isRequired: true

queries:
    - name: ActiveReservations
      description: 
      parameters:  # simple parameters or DTO in case of complex parameters set with validation / permissions etc
       - name: storeId
         description: 
         type: int # can be DTO here
      response:
        responseDto: ReservationInfoDto
        description: 
        isMany: true

commands:
    - name: Reserve
      description:
      events: [BalanceChanged]
      
    - name: Exchange
      description:
      events: [BalanceChanged]

events:
    - name: BalanceChanged
      description:
      type: BalanceChangedDto

key: 
   name: Id
   description: The store's unique identifier 
   type: int
    
attributes:

  - name: Name
    description: The store's common name 
    isRequired: true
    type: string
    maxWidth: 64
    canFilter: true
    canSort: true